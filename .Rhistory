, label = df_lab$min, fontface = 2, hjust = 1, color = 'black') +
annotate("text", x = 2017, y = 17
, label = df_lab$min, fontface = 2, hjust = 1, color = 'blue')
x +
annotate("text", x = 2017, y = 19
, label = df_lab$min, fontface = 2, hjust = 1, color = 'red') +
annotate("text", x = 2017, y = 17.5
, label = df_lab$min, fontface = 2, hjust = 1, color = 'black') +
annotate("text", x = 2017, y = 16
, label = df_lab$min, fontface = 2, hjust = 1, color = 'blue')
x +
annotate("text", x = 2017, y = 19
, label = df_lab$min, fontface = 1, hjust = 1, color = 'red') +
annotate("text", x = 2017, y = 17.5
, label = df_lab$min, fontface = 2, hjust = 1, color = 'black') +
annotate("text", x = 2017, y = 16
, label = df_lab$min, fontface = 2, hjust = 1, color = 'blue')
x +
annotate("text", x = 2017, y = 19
, label = df_lab$min, fontface = ifelse(df_lab$min == 'p < 0.05', 2, 1), hjust = 1, color = 'red') +
annotate("text", x = 2017, y = 17.5
, label = df_lab$min, fontface = 2, hjust = 1, color = 'black') +
annotate("text", x = 2017, y = 16
, label = df_lab$min, fontface = 2, hjust = 1, color = 'blue')
x +
annotate("text", x = 2017, y = 19
, label = df_lab$max, fontface = ifelse(df_lab$max == 'p < 0.05', 2, 1), hjust = 1, color = 'red') +
annotate("text", x = 2017, y = 17.5
, label = df_lab$mean, fontface = ifelse(df_lab$mean == 'p < 0.05', 2, 1), hjust = 1, color = 'black') +
annotate("text", x = 2017, y = 16
, label = df_lab$min, fontface = ifelse(df_lab$min == 'p < 0.05', 2, 1), hjust = 1, color = 'blue')
lm_p_labs <- function(dat_in) {
lm_results <- plt_data %>%
group_by(season) %>%
do(reg_min = lm(min ~ year, data = .)
, reg_mean = lm(mean ~ year, data = .)
, reg_max = lm(max ~ year, data = .))
lm_min_tidy <- tidy(lm_results, reg_min) %>%
filter(term == 'year')
lm_mean_tidy <- tidy(lm_results, reg_mean) %>%
filter(term == 'year')
lm_max_tidy <- tidy(lm_results, reg_max) %>%
filter(term == 'year')
lm_min_tidy$lab <- ifelse(lm_min_tidy$p.value < 0.05, 'p < 0.05', 'p > 0.05')
lm_mean_tidy$lab <- ifelse(lm_mean_tidy$p.value < 0.05, 'p < 0.05', 'p > 0.05')
lm_max_tidy$lab <- ifelse(lm_max_tidy$p.value < 0.05, 'p < 0.05', 'p > 0.05')
df_lab <- data.frame(min = lm_min_tidy$lab, mean = lm_mean_tidy$lab, max = lm_max_tidy$lab, stringsAsFactors = F)
return(df_lab)
}
test <- lm_p_labs(plt_data)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'do_mgl',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::document()
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'do_mgl',
, ln_trend = T
, ln_lab = T
, plot_title = T)
seasonal_dot(dat_wq, param = 'sal',
, ln_trend = T
, ln_lab = T
, plot_title = T)
x <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
devtools::load_all(".")
x <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
View(x)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = F
, ln_lab = F
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
x <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = F
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
x
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
x <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = F
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
View(x)
lm_p_labs(x)
plt_data <- x
lm_results <- plt_data %>%
group_by(season) %>%
do(reg_min = lm(min ~ year, data = .)
, reg_mean = lm(mean ~ year, data = .)
, reg_max = lm(max ~ year, data = .))
lm_min_tidy <- tidy(lm_results, reg_min) %>%
filter(term == 'year')
lm_mean_tidy <- tidy(lm_results, reg_mean) %>%
filter(term == 'year')
lm_max_tidy <- tidy(lm_results, reg_max) %>%
filter(term == 'year')
lm_min_tidy$lab <- ifelse(lm_min_tidy$p.value < 0.05, 'p < 0.05', 'p > 0.05')
lm_mean_tidy$lab <- ifelse(lm_mean_tidy$p.value < 0.05, 'p < 0.05', 'p > 0.05')
lm_max_tidy$lab <- ifelse(lm_max_tidy$p.value < 0.05, 'p < 0.05', 'p > 0.05')
df_lab <- data.frame(min = lm_min_tidy$lab, mean = lm_mean_tidy$lab, max = lm_max_tidy$lab, stringsAsFactors = F)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
devtools::load_all(".")
devtools::document()
devtools::load_all(".")
?tidy
lm_min_tidy <- tidy(lm_results, reg_min) %>%
filter(.data$term == 'year')
lm_min_tidy <- tidy(lm_results$reg_min) %>%
filter(.data$term == 'year')
devtools::load_all(".")
devtools::load_all(".")
devtools::document()
devtools::document()
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
lm_labs(plt_data)
lm_p_labs(plt_data)
x <- plt_data
lm_p_labs(x)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
, plot_title = T)
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
lm_min_tidy <- tidy(lm_results)#, reg_min)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
tmp <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
tmp %>% unnest()
?tidy
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
tmp <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
tmp <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
tmp <-
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
glance(lm_min_tidy)
glance(lm_results)
glance(lm_results$reg_min)
class(lm_results$reg_min)
class(lm_results$reg_min[1])
lm_results$reg_min[1]
lm_results$reg_min[2]
lm_results$reg_min[[2]]
View(lm_results)
lm_results$reg_min$season
lm_results$reg_min$coefficients
unlist(lm_results)
chk <- unlist(lm_results)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
warnings()
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
?do
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
data(elksmwq)
dat_wq <- elksmwq
dat_wq <- subset(dat_wq, subset = c('2007-01-01 0:00', '2017-01-01 0:00'))
dat_wq <- qaqc(dat_wq, qaqc_keep = c(0, 3, 5))
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
library(dplyr)
library(rlang)
library(SWMPr)
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
devtools::load_all(".")
system.time(
seasonal_dot(dat_nut, param = 'chla_n',
, ln_trend = F
, ln_lab = F
, plot_title = T)
)
system.time(
seasonal_dot(dat_wq, param = 'temp',
, ln_trend = T
, ln_lab = T
, plot_title = T)
)
data(elksmnut)
dat_nut <- elksmnut
dat_nut <- subset(dat_nut, subset = c('2007-01-01 0:00', '2017-01-01 0:00'))
dat_nut <- qaqc(dat_nut, qaqc_keep = c(0, 3, 5))
seasonal_dot(dat_nut, param = 'chla_n',
, ln_trend = F
, ln_lab = F
, plot_title = T)
seasonal_dot(dat_nut, param = 'chla_n',
, ln_trend = F
, ln_lab = F
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
seasonal_dot(dat_nut, param = 'chla_n',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
x <-
seasonal_dot(dat_nut, param = 'chla_n',
, ln_trend = T
, ln_lab = T
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
x +
scale_y_continuous(limits = c(0, 20))
x <-
seasonal_dot(dat_nut, param = 'chla_n',
, ln_trend = F
, ln_lab = F
, season = list(c(1,2,3), c(4,5,6), c(7,8,9), c(10, 11, 12))
, season_names = c('Winter', 'Spring', 'Summer', 'Fall')
, plot_title = T)
x +
scale_y_continuous(limits = c(0, 20))
